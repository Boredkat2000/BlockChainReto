{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\katri\\\\CascadeProjects\\\\blockchain-voting-platform\\\\client\\\\src\\\\components\\\\voting\\\\VotingInterface.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useContext } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { Container, Card, Row, Col, Form, Button, Alert, Spinner, Modal } from 'react-bootstrap';\nimport { ethers } from 'ethers';\nimport { toast } from 'react-toastify';\nimport AuthContext from '../../context/AuthContext';\nimport { formatTimestamp, isElectionActive } from '../../utils/contractUtils';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst VotingInterface = () => {\n  _s();\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const [election, setElection] = useState(null);\n  const [selectedCandidate, setSelectedCandidate] = useState('');\n  const [voterStatus, setVoterStatus] = useState({\n    isRegistered: false,\n    hasVoted: false\n  });\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n  const [error, setError] = useState('');\n  const [showConfirmModal, setShowConfirmModal] = useState(false);\n  const {\n    isAuthenticated,\n    userAddress,\n    contract,\n    signer\n  } = useContext(AuthContext);\n  useEffect(() => {\n    if (!isAuthenticated) {\n      navigate('/login');\n      return;\n    }\n    fetchElectionDetails();\n  }, [id, isAuthenticated, navigate]);\n  useEffect(() => {\n    if (isAuthenticated && userAddress && election) {\n      checkVoterStatus();\n    }\n  }, [isAuthenticated, userAddress, election]);\n  const fetchElectionDetails = async () => {\n    try {\n      setLoading(true);\n\n      // Fetching from API\n      const response = await fetch(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/elections/${id}`);\n      const data = await response.json();\n      if (!data.success) {\n        throw new Error(data.message || 'Failed to fetch election details');\n      }\n      setElection(data.election);\n\n      // Check if election is active\n      if (!isElectionActive(data.election)) {\n        navigate(`/elections/${id}`);\n        toast.error('This election is not currently active for voting');\n      }\n      setError('');\n    } catch (error) {\n      console.error('Error fetching election details:', error);\n      setError('Failed to load election details. Please try again later.');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const checkVoterStatus = async () => {\n    try {\n      if (!isAuthenticated || !userAddress) return;\n      const token = localStorage.getItem('auth_token');\n      const response = await fetch(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/voters/status/${id}`, {\n        headers: {\n          'x-auth-token': token\n        }\n      });\n      const data = await response.json();\n      if (data.success) {\n        setVoterStatus(data.status);\n\n        // Redirect if not registered or already voted\n        if (!data.status.isRegistered) {\n          navigate(`/elections/${id}`);\n          toast.error('You are not registered for this election');\n        } else if (data.status.hasVoted) {\n          navigate(`/elections/${id}`);\n          toast.info('You have already voted in this election');\n        }\n      }\n    } catch (error) {\n      console.error('Error checking voter status:', error);\n      setError('Failed to verify voter eligibility. Please try again later.');\n    }\n  };\n  const handleCandidateChange = e => {\n    setSelectedCandidate(e.target.value);\n  };\n  const handleSubmit = e => {\n    e.preventDefault();\n    if (!selectedCandidate) {\n      toast.error('Please select a candidate');\n      return;\n    }\n    setShowConfirmModal(true);\n  };\n  const confirmVote = async () => {\n    try {\n      setSubmitting(true);\n\n      // Close the modal\n      setShowConfirmModal(false);\n      if (!contract || !signer) {\n        throw new Error('Blockchain connection not established');\n      }\n\n      // Get the JWT token for authentication\n      const token = localStorage.getItem('auth_token');\n\n      // Step 1: Get transaction data from the server\n      const prepResponse = await fetch(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/voters/vote`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'x-auth-token': token\n        },\n        body: JSON.stringify({\n          electionId: id,\n          candidateId: selectedCandidate\n        })\n      });\n      const prepData = await prepResponse.json();\n      if (!prepData.success) {\n        throw new Error(prepData.message || 'Failed to prepare vote transaction');\n      }\n\n      // Step 2: Sign and send the transaction\n      const contractWithSigner = contract.connect(signer);\n      toast.info('Please confirm the transaction in your wallet');\n\n      // Execute the vote transaction\n      const tx = await contractWithSigner.castVote(id, selectedCandidate);\n      toast.info('Transaction submitted. Waiting for confirmation...');\n\n      // Wait for transaction confirmation\n      const receipt = await tx.wait();\n      toast.success('Your vote has been successfully recorded on the blockchain!');\n\n      // Redirect to election details page\n      navigate(`/elections/${id}`);\n    } catch (error) {\n      console.error('Error casting vote:', error);\n      setError(error.message || 'Failed to cast vote. Please try again.');\n      toast.error(error.message || 'Failed to cast vote');\n    } finally {\n      setSubmitting(false);\n      setShowConfirmModal(false);\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"text-center my-5\",\n      children: [/*#__PURE__*/_jsxDEV(Spinner, {\n        animation: \"border\",\n        role: \"status\",\n        variant: \"primary\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"visually-hidden\",\n          children: \"Loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-3\",\n        children: \"Loading voting interface...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"my-5\",\n      children: [/*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"danger\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"primary\",\n        onClick: fetchElectionDetails,\n        children: \"Retry\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outline-secondary\",\n        className: \"ms-2\",\n        onClick: () => navigate(`/elections/${id}`),\n        children: \"Back to Election\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 7\n    }, this);\n  }\n  if (!election || !election.candidates || election.candidates.length === 0) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"my-5\",\n      children: [/*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"warning\",\n        children: \"Election information is unavailable or has no candidates.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outline-secondary\",\n        onClick: () => navigate(`/elections/${id}`),\n        children: \"Back to Election\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"mb-4\",\n      children: \"Cast Your Vote\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      className: \"mb-4 shadow-sm\",\n      children: /*#__PURE__*/_jsxDEV(Card.Body, {\n        children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n          children: election.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Card.Text, {\n          children: election.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"small text-muted\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Start:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 18\n            }, this), \" \", formatTimestamp(election.startTime)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"End:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 18\n            }, this), \" \", formatTimestamp(election.endTime)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        lg: 8,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          className: \"shadow-sm\",\n          children: [/*#__PURE__*/_jsxDEV(Card.Header, {\n            children: /*#__PURE__*/_jsxDEV(\"h5\", {\n              className: \"mb-0\",\n              children: \"Select a Candidate\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Card.Body, {\n            children: /*#__PURE__*/_jsxDEV(Form, {\n              onSubmit: handleSubmit,\n              children: [election.candidates.map(candidate => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mb-3\",\n                children: /*#__PURE__*/_jsxDEV(Card, {\n                  className: `border ${selectedCandidate === candidate.id.toString() ? 'border-primary' : ''}`,\n                  children: /*#__PURE__*/_jsxDEV(Card.Body, {\n                    children: /*#__PURE__*/_jsxDEV(Form.Check, {\n                      type: \"radio\",\n                      id: `candidate-${candidate.id}`,\n                      name: \"candidateSelection\",\n                      value: candidate.id,\n                      checked: selectedCandidate === candidate.id.toString(),\n                      onChange: handleCandidateChange,\n                      label: /*#__PURE__*/_jsxDEV(\"div\", {\n                        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                          children: candidate.name\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 246,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                          className: \"mb-0 text-muted\",\n                          children: candidate.description\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 247,\n                          columnNumber: 31\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 245,\n                        columnNumber: 29\n                      }, this),\n                      className: \"d-flex align-items-start gap-3\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 237,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 236,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 235,\n                  columnNumber: 21\n                }, this)\n              }, candidate.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 19\n              }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-grid gap-2 mt-4\",\n                children: [/*#__PURE__*/_jsxDEV(Button, {\n                  type: \"submit\",\n                  variant: \"primary\",\n                  size: \"lg\",\n                  disabled: !selectedCandidate || submitting,\n                  children: submitting ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                    children: [/*#__PURE__*/_jsxDEV(Spinner, {\n                      as: \"span\",\n                      animation: \"border\",\n                      size: \"sm\",\n                      role: \"status\",\n                      \"aria-hidden\": \"true\",\n                      className: \"me-2\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 266,\n                      columnNumber: 25\n                    }, this), \"Processing...\"]\n                  }, void 0, true) : 'Submit Vote'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 258,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"outline-secondary\",\n                  onClick: () => navigate(`/elections/${id}`),\n                  disabled: submitting,\n                  children: \"Cancel\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 280,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 257,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        lg: 4,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          className: \"shadow-sm\",\n          children: [/*#__PURE__*/_jsxDEV(Card.Header, {\n            children: /*#__PURE__*/_jsxDEV(\"h5\", {\n              className: \"mb-0\",\n              children: \"Voting Information\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 296,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Card.Body, {\n            children: [/*#__PURE__*/_jsxDEV(Alert, {\n              variant: \"info\",\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-info-circle me-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 300,\n                columnNumber: 17\n              }, this), \"Your vote will be securely recorded on the blockchain. This requires a small transaction fee.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 299,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                children: \"How Voting Works:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 305,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"ol\", {\n                className: \"small ps-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"Select your preferred candidate\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 307,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"Confirm your selection\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 308,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"Sign the transaction with your wallet\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 309,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"Wait for blockchain confirmation\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 310,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                children: \"Important Notes:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 315,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"small ps-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"Your vote is anonymous\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 317,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"You can only vote once\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 318,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"Votes cannot be changed after submission\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 319,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"You need enough ETH in your wallet for gas fees\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 320,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 316,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      show: showConfirmModal,\n      onHide: () => setShowConfirmModal(false),\n      centered: true,\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        closeButton: true,\n        children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n          children: \"Confirm Your Vote\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n        children: election.candidates && selectedCandidate !== '' && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"You are about to vote for:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"mb-3\",\n            children: election.candidates[parseInt(selectedCandidate)].name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 337,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Alert, {\n            variant: \"warning\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-exclamation-triangle me-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 339,\n              columnNumber: 17\n            }, this), \"This action cannot be undone once confirmed on the blockchain.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          variant: \"secondary\",\n          onClick: () => setShowConfirmModal(false),\n          disabled: submitting,\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 346,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"primary\",\n          onClick: confirmVote,\n          disabled: submitting,\n          children: submitting ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Spinner, {\n              as: \"span\",\n              animation: \"border\",\n              size: \"sm\",\n              role: \"status\",\n              \"aria-hidden\": \"true\",\n              className: \"me-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 17\n            }, this), \"Processing...\"]\n          }, void 0, true) : 'Confirm Vote'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 211,\n    columnNumber: 5\n  }, this);\n};\n_s(VotingInterface, \"mxOgJ1RAtW+aKYxYphJYMIqjnJA=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = VotingInterface;\nexport default VotingInterface;\nvar _c;\n$RefreshReg$(_c, \"VotingInterface\");","map":{"version":3,"names":["React","useState","useEffect","useContext","useParams","useNavigate","Container","Card","Row","Col","Form","Button","Alert","Spinner","Modal","ethers","toast","AuthContext","formatTimestamp","isElectionActive","jsxDEV","_jsxDEV","Fragment","_Fragment","VotingInterface","_s","id","navigate","election","setElection","selectedCandidate","setSelectedCandidate","voterStatus","setVoterStatus","isRegistered","hasVoted","loading","setLoading","submitting","setSubmitting","error","setError","showConfirmModal","setShowConfirmModal","isAuthenticated","userAddress","contract","signer","fetchElectionDetails","checkVoterStatus","response","fetch","process","env","REACT_APP_API_URL","data","json","success","Error","message","console","token","localStorage","getItem","headers","status","info","handleCandidateChange","e","target","value","handleSubmit","preventDefault","confirmVote","prepResponse","method","body","JSON","stringify","electionId","candidateId","prepData","contractWithSigner","connect","tx","castVote","receipt","wait","className","children","animation","role","variant","fileName","_jsxFileName","lineNumber","columnNumber","onClick","candidates","length","Body","Title","title","Text","description","startTime","endTime","lg","Header","onSubmit","map","candidate","toString","Check","type","name","checked","onChange","label","size","disabled","as","show","onHide","centered","closeButton","parseInt","Footer","_c","$RefreshReg$"],"sources":["C:/Users/katri/CascadeProjects/blockchain-voting-platform/client/src/components/voting/VotingInterface.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { Container, Card, Row, Col, Form, Button, Alert, Spinner, Modal } from 'react-bootstrap';\nimport { ethers } from 'ethers';\nimport { toast } from 'react-toastify';\nimport AuthContext from '../../context/AuthContext';\nimport { formatTimestamp, isElectionActive } from '../../utils/contractUtils';\n\nconst VotingInterface = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [election, setElection] = useState(null);\n  const [selectedCandidate, setSelectedCandidate] = useState('');\n  const [voterStatus, setVoterStatus] = useState({ isRegistered: false, hasVoted: false });\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n  const [error, setError] = useState('');\n  const [showConfirmModal, setShowConfirmModal] = useState(false);\n  const { isAuthenticated, userAddress, contract, signer } = useContext(AuthContext);\n\n  useEffect(() => {\n    if (!isAuthenticated) {\n      navigate('/login');\n      return;\n    }\n    \n    fetchElectionDetails();\n  }, [id, isAuthenticated, navigate]);\n\n  useEffect(() => {\n    if (isAuthenticated && userAddress && election) {\n      checkVoterStatus();\n    }\n  }, [isAuthenticated, userAddress, election]);\n\n  const fetchElectionDetails = async () => {\n    try {\n      setLoading(true);\n      \n      // Fetching from API\n      const response = await fetch(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/elections/${id}`);\n      const data = await response.json();\n      \n      if (!data.success) {\n        throw new Error(data.message || 'Failed to fetch election details');\n      }\n      \n      setElection(data.election);\n      \n      // Check if election is active\n      if (!isElectionActive(data.election)) {\n        navigate(`/elections/${id}`);\n        toast.error('This election is not currently active for voting');\n      }\n      \n      setError('');\n    } catch (error) {\n      console.error('Error fetching election details:', error);\n      setError('Failed to load election details. Please try again later.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const checkVoterStatus = async () => {\n    try {\n      if (!isAuthenticated || !userAddress) return;\n      \n      const token = localStorage.getItem('auth_token');\n      \n      const response = await fetch(\n        `${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/voters/status/${id}`,\n        {\n          headers: {\n            'x-auth-token': token\n          }\n        }\n      );\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setVoterStatus(data.status);\n        \n        // Redirect if not registered or already voted\n        if (!data.status.isRegistered) {\n          navigate(`/elections/${id}`);\n          toast.error('You are not registered for this election');\n        } else if (data.status.hasVoted) {\n          navigate(`/elections/${id}`);\n          toast.info('You have already voted in this election');\n        }\n      }\n    } catch (error) {\n      console.error('Error checking voter status:', error);\n      setError('Failed to verify voter eligibility. Please try again later.');\n    }\n  };\n\n  const handleCandidateChange = (e) => {\n    setSelectedCandidate(e.target.value);\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    if (!selectedCandidate) {\n      toast.error('Please select a candidate');\n      return;\n    }\n    setShowConfirmModal(true);\n  };\n\n  const confirmVote = async () => {\n    try {\n      setSubmitting(true);\n      \n      // Close the modal\n      setShowConfirmModal(false);\n      \n      if (!contract || !signer) {\n        throw new Error('Blockchain connection not established');\n      }\n      \n      // Get the JWT token for authentication\n      const token = localStorage.getItem('auth_token');\n      \n      // Step 1: Get transaction data from the server\n      const prepResponse = await fetch(\n        `${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/voters/vote`,\n        {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'x-auth-token': token\n          },\n          body: JSON.stringify({\n            electionId: id,\n            candidateId: selectedCandidate\n          })\n        }\n      );\n      \n      const prepData = await prepResponse.json();\n      \n      if (!prepData.success) {\n        throw new Error(prepData.message || 'Failed to prepare vote transaction');\n      }\n      \n      // Step 2: Sign and send the transaction\n      const contractWithSigner = contract.connect(signer);\n      \n      toast.info('Please confirm the transaction in your wallet');\n      \n      // Execute the vote transaction\n      const tx = await contractWithSigner.castVote(id, selectedCandidate);\n      \n      toast.info('Transaction submitted. Waiting for confirmation...');\n      \n      // Wait for transaction confirmation\n      const receipt = await tx.wait();\n      \n      toast.success('Your vote has been successfully recorded on the blockchain!');\n      \n      // Redirect to election details page\n      navigate(`/elections/${id}`);\n    } catch (error) {\n      console.error('Error casting vote:', error);\n      setError(error.message || 'Failed to cast vote. Please try again.');\n      toast.error(error.message || 'Failed to cast vote');\n    } finally {\n      setSubmitting(false);\n      setShowConfirmModal(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <Container className=\"text-center my-5\">\n        <Spinner animation=\"border\" role=\"status\" variant=\"primary\">\n          <span className=\"visually-hidden\">Loading...</span>\n        </Spinner>\n        <p className=\"mt-3\">Loading voting interface...</p>\n      </Container>\n    );\n  }\n\n  if (error) {\n    return (\n      <Container className=\"my-5\">\n        <Alert variant=\"danger\">{error}</Alert>\n        <Button variant=\"primary\" onClick={fetchElectionDetails}>Retry</Button>\n        <Button variant=\"outline-secondary\" className=\"ms-2\" onClick={() => navigate(`/elections/${id}`)}>\n          Back to Election\n        </Button>\n      </Container>\n    );\n  }\n\n  if (!election || !election.candidates || election.candidates.length === 0) {\n    return (\n      <Container className=\"my-5\">\n        <Alert variant=\"warning\">Election information is unavailable or has no candidates.</Alert>\n        <Button variant=\"outline-secondary\" onClick={() => navigate(`/elections/${id}`)}>\n          Back to Election\n        </Button>\n      </Container>\n    );\n  }\n\n  return (\n    <Container>\n      <h2 className=\"mb-4\">Cast Your Vote</h2>\n      \n      <Card className=\"mb-4 shadow-sm\">\n        <Card.Body>\n          <Card.Title>{election.title}</Card.Title>\n          <Card.Text>{election.description}</Card.Text>\n          <div className=\"small text-muted\">\n            <div><strong>Start:</strong> {formatTimestamp(election.startTime)}</div>\n            <div><strong>End:</strong> {formatTimestamp(election.endTime)}</div>\n          </div>\n        </Card.Body>\n      </Card>\n      \n      <Row>\n        <Col lg={8}>\n          <Card className=\"shadow-sm\">\n            <Card.Header>\n              <h5 className=\"mb-0\">Select a Candidate</h5>\n            </Card.Header>\n            <Card.Body>\n              <Form onSubmit={handleSubmit}>\n                {election.candidates.map((candidate) => (\n                  <div key={candidate.id} className=\"mb-3\">\n                    <Card className={`border ${selectedCandidate === candidate.id.toString() ? 'border-primary' : ''}`}>\n                      <Card.Body>\n                        <Form.Check\n                          type=\"radio\"\n                          id={`candidate-${candidate.id}`}\n                          name=\"candidateSelection\"\n                          value={candidate.id}\n                          checked={selectedCandidate === candidate.id.toString()}\n                          onChange={handleCandidateChange}\n                          label={\n                            <div>\n                              <h5>{candidate.name}</h5>\n                              <p className=\"mb-0 text-muted\">{candidate.description}</p>\n                            </div>\n                          }\n                          className=\"d-flex align-items-start gap-3\"\n                        />\n                      </Card.Body>\n                    </Card>\n                  </div>\n                ))}\n                \n                <div className=\"d-grid gap-2 mt-4\">\n                  <Button\n                    type=\"submit\"\n                    variant=\"primary\"\n                    size=\"lg\"\n                    disabled={!selectedCandidate || submitting}\n                  >\n                    {submitting ? (\n                      <>\n                        <Spinner\n                          as=\"span\"\n                          animation=\"border\"\n                          size=\"sm\"\n                          role=\"status\"\n                          aria-hidden=\"true\"\n                          className=\"me-2\"\n                        />\n                        Processing...\n                      </>\n                    ) : (\n                      'Submit Vote'\n                    )}\n                  </Button>\n                  <Button\n                    variant=\"outline-secondary\"\n                    onClick={() => navigate(`/elections/${id}`)}\n                    disabled={submitting}\n                  >\n                    Cancel\n                  </Button>\n                </div>\n              </Form>\n            </Card.Body>\n          </Card>\n        </Col>\n        \n        <Col lg={4}>\n          <Card className=\"shadow-sm\">\n            <Card.Header>\n              <h5 className=\"mb-0\">Voting Information</h5>\n            </Card.Header>\n            <Card.Body>\n              <Alert variant=\"info\">\n                <i className=\"fas fa-info-circle me-2\"></i>\n                Your vote will be securely recorded on the blockchain. This requires a small transaction fee.\n              </Alert>\n              \n              <div className=\"mb-3\">\n                <h6>How Voting Works:</h6>\n                <ol className=\"small ps-3\">\n                  <li>Select your preferred candidate</li>\n                  <li>Confirm your selection</li>\n                  <li>Sign the transaction with your wallet</li>\n                  <li>Wait for blockchain confirmation</li>\n                </ol>\n              </div>\n              \n              <div className=\"mb-3\">\n                <h6>Important Notes:</h6>\n                <ul className=\"small ps-3\">\n                  <li>Your vote is anonymous</li>\n                  <li>You can only vote once</li>\n                  <li>Votes cannot be changed after submission</li>\n                  <li>You need enough ETH in your wallet for gas fees</li>\n                </ul>\n              </div>\n            </Card.Body>\n          </Card>\n        </Col>\n      </Row>\n      \n      {/* Confirmation Modal */}\n      <Modal show={showConfirmModal} onHide={() => setShowConfirmModal(false)} centered>\n        <Modal.Header closeButton>\n          <Modal.Title>Confirm Your Vote</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          {election.candidates && selectedCandidate !== '' && (\n            <>\n              <p>You are about to vote for:</p>\n              <h4 className=\"mb-3\">{election.candidates[parseInt(selectedCandidate)].name}</h4>\n              <Alert variant=\"warning\">\n                <i className=\"fas fa-exclamation-triangle me-2\"></i>\n                This action cannot be undone once confirmed on the blockchain.\n              </Alert>\n            </>\n          )}\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={() => setShowConfirmModal(false)} disabled={submitting}>\n            Cancel\n          </Button>\n          <Button variant=\"primary\" onClick={confirmVote} disabled={submitting}>\n            {submitting ? (\n              <>\n                <Spinner\n                  as=\"span\"\n                  animation=\"border\"\n                  size=\"sm\"\n                  role=\"status\"\n                  aria-hidden=\"true\"\n                  className=\"me-2\"\n                />\n                Processing...\n              </>\n            ) : (\n              'Confirm Vote'\n            )}\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    </Container>\n  );\n};\n\nexport default VotingInterface;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}